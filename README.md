# PolyPure

Создаем минималистичное и стильное приложение для знакомств, в первую очередь для студентов Политеха (и других вузов), с возможностью масштабирования.

---

## Тема проекта

**PolyPure** — мини-приложение для знакомств в **Telegram** для студентов университета, где основная идея — находить общие точки соприкосновения не только по интересам, но и по расписанию (свободные пары/окна).  
Это упрощает возможность встретиться в реальной жизни.

---

## Состав группы

- **Анисимов В.А.** — 5130904/30107  
- **Груздев В.Д.** — 5130904/30107  
- **Соколов М.В.** — 5130904/30107  
- **Яковлев И.А.** — 5130904/30107  

---

## Технологический стек

**Фронтенд (Мини-апп):** React.js  
**Бэкенд (Сервер):** Node.js + Express.js  
**База данных:** PostgreSQL (надежнее для связей)  
**Аутентификация:** Telegram Login (Telegram Auth)  

**Внешние API:**
- Telegram API — для логина и, в перспективе, отправки уведомлений  
- API Расписания — открытый API расписания  

---

## Определение проблемы

На рынке приложений для знакомств нет ни одного, которое бы ориентировалось на студентов.  
Мы создаем приложение, которое будет синхронизироваться с расписанием и предлагать пользователей с аналогичных факультетов и схожими интересами.  
Это позволит находить пары с общими увлечениями и схожим графиком.

---

## Выработка требований

**Регистрация через Telegram**  
Как новый пользователь,  
Я хочу зарегистрироваться в приложении, используя свой аккаунт Telegram,  
Чтобы быстро начать пользоваться сервисом без необходимости запоминать новый логин и пароль, а также чтобы мой профиль был сразу верифицирован.

---

**Привязка учебного расписания**  
Как студент,  
Я хочу привязать свое учебное расписание из API Политеха (или другого вуза) к профилю,  
Чтобы система могла показывать мне людей с моего факультета или потока, а также чтобы в будущем упростить организацию встреч (например, показать, что у нас есть "окно" в расписании).

---

**Сценарий поиска знакомств**  
Когда я хочу познакомиться с новыми людьми из своего университета,  
Я хочу просматривать анкеты студентов с моего факультета и свайпать их (лайк/дизлайк),  
Чтобы найти людей с общими интересами и учебной средой.  
Также должны отображаться анкеты студентов, у которых сейчас пары в том же корпусе, где у меня.

---

 # Разработка архитектуры и проектирование

---

## 1. Контекстная диаграмма (C4 Level 1)

**Система:** PolyDate — Telegram мини-приложение для знакомств студентов  
**Основная цель:** Помочь студентам находить знакомства на основе общих интересов и совпадающего расписания

### Взаимодействия:

**Студент использует PolyDate через Telegram для:**
- Регистрации и аутентификации  
- Настройки профиля и интересов  
- Просмотра и оценки анкет  
- Организации встреч  

**PolyDate взаимодействует с:**
- Telegram API — для аутентификации и уведомлений  
- API Расписания СПбПУ — для получения данных о расписании  
- PostgreSQL — для хранения данных пользователей и предпочтений  

---

## 2. Диаграмма контейнеров (C4 Level 2)

### Схема взаимодействия компонентов

```text
┌─────────────────┐     ┌──────────────────┐     ┌─────────────────┐
│   Telegram      │     │     PolyDate     │     │    Внешние API  │
│   Mini App      │◄──► │     Backend      │◄──► │  Расписания     │
│   (React)       │     │   (Node.js)      │     │ (ruz.spbstu.ru) │
└─────────────────┘     └──────────────────┘     └─────────────────┘
                                 │
                                 ▼
                        ┌─────────────────┐
                        │   PostgreSQL    │
                        │    Database     │
                        └─────────────────┘
```
---

## 3. Детальная архитектура системы
Оценка масштаба системы:
Количество пользователей: 10 000+ активных пользователей в сутки
Период хранения информации: > 5 лет (история мэтчей, сообщений, профилей)
1. Low Latency (Низкая задержка) при операциях Чтения (R)
•	Требование: Время отклика системы на действие пользователя (лайк, загрузка новой анкеты) не должно превышать 500 мс.
•	Почему это самое важное:
o	Влияние на пользователя: Любое "зависание" при свайпе мгновенно убивает геймификацию и удовольствие от использования. Пользователь просто закроет приложение.
o	Ключевой сценарий: Весь основной UX — это быстрое принятие решений (лайк/дизлайк). Если анкеты подгружаются медленно, вся концепция рушится.
•	Что делать: Кэшировать предварительно подготовленные анкеты и использовать быстрые базы данных (как Redis) для очереди свайпов.
________________________________________
2. High Read Throughput (Высокая пропускная способность по чтению)
•	Требование: Система должна выдерживать пиковую нагрузку в ~100 операций Чтения в секунду (R QPS).
•	Почему это важно:
o	Масштаб: 10 000+ активных пользователей не будут работать равномерно. В обеденный перерыв или вечером 1000+ человек одновременно начнут листать анкеты. Если система "ляжет" в самый популярный час — это провал.
o	Соотношение R/W:  нагрузка будет в основном на чтение (80%/20%). Все архитектурные решения должны быть заточены под это.
•	Что делать: Использовать реплики базы данных для разгрузки операций чтения и эффективное кэширование.
________________________________________
3. Eventual Consistency & High Availability (Условная согласованность и Высокая доступность)
•	Требование: Система должна оставаться доступной всегда, даже если это приведет к небольшой задержке в синхронизации данных (например, пользователь увидит мэтч через 1-2 секунды после взаимного лайка).
•	Почему это важно:
o	Для приложений такого типа доступность важнее, чем мгновенная консистентность. Пользователь простит небольшую задержку в получении уведомления о мэтче, но никогда не простит, если приложение не открывается.
o	Реалии распределенных систем: Выбор в пользу Eventual Consistency сильно упростит архитектуру и повысит отказоустойчивость.
•	Что делать: Спроектировать сервисы (например, обработку лайков и мэтчей) как независимые, асинхронно обменивающиеся сообщениями через брокеры (например, RabbitMQ или Kafka).
________________________________________
•	Storage (Disk/RAM): Кэшировать ВСЕ, что читается часто — списки анкет, расписания на текущую неделю. 
•	Costs: Самые большие затраты будут на хранение данных (5 лет — это много) и на оперативную память для кэша. Будет использоваться облака с гибкой тарификацией.


### 3.1. Компоненты бэкенда

```javascript
// Основные модули сервера
src/
├── controllers/          # Обработчики запросов
│   ├── auth.js          # Аутентификация через Telegram
│   ├── profile.js       # Управление профилем
│   ├── matching.js      # Алгоритм подбора пар
│   └── schedule.js      # Работа с расписанием
├── services/            # Бизнес-логика
│   ├── matching/        # Алгоритмы matching'а
│   ├── notification/    # Уведомления
│   └── schedule/        # Синхронизация расписания
├── models/              # Модели данных
├── middleware/          # Промежуточное ПО
├── routes/              # Маршруты API
└── utils/               # Вспомогательные функции
